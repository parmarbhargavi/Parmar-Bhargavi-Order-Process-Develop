2020-04-19 11:26:48.1515|INFO|OrderProcess.API.Program|Initializing application...
2020-04-19 11:26:50.2626|INFO|Microsoft.EntityFrameworkCore.Infrastructure|Entity Framework Core 2.1.14-servicing-32113 initialized 'ProcessOrderContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2020-04-19 11:26:54.0659|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (104ms) [Parameters=[], CommandType='Text', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [ProcessDB] SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
END;
2020-04-19 11:26:54.1265|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (46ms) [Parameters=[], CommandType='Text', CommandTimeout='60']
DROP DATABASE [ProcessDB];
2020-04-19 11:27:04.5307|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (363ms) [Parameters=[], CommandType='Text', CommandTimeout='60']
CREATE DATABASE [ProcessDB];
2020-04-19 11:27:04.5994|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (66ms) [Parameters=[], CommandType='Text', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [ProcessDB] SET READ_COMMITTED_SNAPSHOT ON;
END;
2020-04-19 11:27:04.6723|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (9ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
CREATE TABLE [__EFMigrationsHistory] (
    [MigrationId] nvarchar(150) NOT NULL,
    [ProductVersion] nvarchar(32) NOT NULL,
    CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
);
2020-04-19 11:27:04.6723|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-04-19 11:27:04.6848|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2020-04-19 11:27:04.6848|INFO|Microsoft.EntityFrameworkCore.Migrations|Applying migration '20200418185242_Initial'.
2020-04-19 11:27:04.7329|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
CREATE TABLE [Products] (
    [Id] int NOT NULL IDENTITY,
    [AvaliableQuantity] int NOT NULL,
    [Price] decimal(18, 2) NOT NULL,
    CONSTRAINT [PK_Products] PRIMARY KEY ([Id])
);
2020-04-19 11:27:04.7329|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
CREATE TABLE [Users] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(50) NOT NULL,
    CONSTRAINT [PK_Users] PRIMARY KEY ([Id])
);
2020-04-19 11:27:04.7329|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
CREATE TABLE [Orders] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [ProductId] int NOT NULL,
    [Quantity] int NOT NULL,
    CONSTRAINT [PK_Orders] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Orders_Products_ProductId] FOREIGN KEY ([ProductId]) REFERENCES [Products] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Orders_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2020-04-19 11:27:04.7795|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (33ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'AvaliableQuantity', N'Price') AND [object_id] = OBJECT_ID(N'[Products]'))
    SET IDENTITY_INSERT [Products] ON;
INSERT INTO [Products] ([Id], [AvaliableQuantity], [Price])
VALUES (1, 10, 100.0),
(2, 3, 1000.0),
(3, 0, 10.0);
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'AvaliableQuantity', N'Price') AND [object_id] = OBJECT_ID(N'[Products]'))
    SET IDENTITY_INSERT [Products] OFF;
2020-04-19 11:27:04.7921|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (9ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Name') AND [object_id] = OBJECT_ID(N'[Users]'))
    SET IDENTITY_INSERT [Users] ON;
INSERT INTO [Users] ([Id], [Name])
VALUES (1, N'Sam'),
(2, N'Bob'),
(3, N'Ben');
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Name') AND [object_id] = OBJECT_ID(N'[Users]'))
    SET IDENTITY_INSERT [Users] OFF;
2020-04-19 11:27:04.8063|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (11ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'ProductId', N'Quantity', N'UserId') AND [object_id] = OBJECT_ID(N'[Orders]'))
    SET IDENTITY_INSERT [Orders] ON;
INSERT INTO [Orders] ([Id], [ProductId], [Quantity], [UserId])
VALUES (1, 1, 10, 1),
(2, 1, 10, 1),
(3, 2, 10, 2),
(4, 3, 10, 2),
(5, 2, 10, 3),
(6, 3, 10, 3);
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'ProductId', N'Quantity', N'UserId') AND [object_id] = OBJECT_ID(N'[Orders]'))
    SET IDENTITY_INSERT [Orders] OFF;
2020-04-19 11:27:04.8063|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
CREATE INDEX [IX_Orders_ProductId] ON [Orders] ([ProductId]);
2020-04-19 11:27:04.8063|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
CREATE INDEX [IX_Orders_UserId] ON [Orders] ([UserId]);
2020-04-19 11:27:04.8063|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20200418185242_Initial', N'2.1.14-servicing-32113');
2020-04-19 11:27:04.8248|INFO|Microsoft.EntityFrameworkCore.Migrations|Applying migration '20200418185321_Initial1'.
2020-04-19 11:27:04.8954|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (58ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
DECLARE @var0 sysname;
SELECT @var0 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Products]') AND [c].[name] = N'Price');
IF @var0 IS NOT NULL EXEC(N'ALTER TABLE [Products] DROP CONSTRAINT [' + @var0 + '];');
ALTER TABLE [Products] ALTER COLUMN [Price] int NOT NULL;
2020-04-19 11:27:04.8954|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
UPDATE [Products] SET [Price] = 100
WHERE [Id] = 1;
SELECT @@ROWCOUNT;
2020-04-19 11:27:04.9025|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
UPDATE [Products] SET [Price] = 1000
WHERE [Id] = 2;
SELECT @@ROWCOUNT;
2020-04-19 11:27:04.9025|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
UPDATE [Products] SET [Price] = 10
WHERE [Id] = 3;
SELECT @@ROWCOUNT;
2020-04-19 11:27:04.9025|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20200418185321_Initial1', N'2.1.14-servicing-32113');
2020-04-19 11:27:05.0108|INFO|Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager|User profile is available. Using 'C:\Users\kvankadari\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2020-04-19 11:27:05.5757|INFO|Microsoft.AspNetCore.Hosting.Internal.WebHost|Request starting HTTP/1.1 DEBUG http://localhost:1028/  0
2020-04-19 11:27:05.5757|INFO|Microsoft.AspNetCore.Hosting.Internal.WebHost|Request starting HTTP/1.1 GET http://localhost:1028/  
2020-04-19 11:27:05.6525|INFO|Microsoft.AspNetCore.Hosting.Internal.WebHost|Request finished in 74.9554ms 200 
2020-04-19 11:27:05.8102|INFO|Microsoft.AspNetCore.Hosting.Internal.WebHost|Request finished in 237.9071ms 404 text/plain
2020-04-19 16:31:29.6002|INFO|OrderProcess.API.Program|Initializing application...
2020-04-19 16:31:32.2278|INFO|Microsoft.EntityFrameworkCore.Infrastructure|Entity Framework Core 2.1.14-servicing-32113 initialized 'ProcessOrderContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2020-04-19 16:31:33.4722|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (60ms) [Parameters=[], CommandType='Text', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [ProcessDB] SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
END;
2020-04-19 16:31:33.4947|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (20ms) [Parameters=[], CommandType='Text', CommandTimeout='60']
DROP DATABASE [ProcessDB];
2020-04-19 16:31:43.8738|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (354ms) [Parameters=[], CommandType='Text', CommandTimeout='60']
CREATE DATABASE [ProcessDB];
2020-04-19 16:31:43.9269|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (51ms) [Parameters=[], CommandType='Text', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [ProcessDB] SET READ_COMMITTED_SNAPSHOT ON;
END;
2020-04-19 16:31:43.9698|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (7ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
CREATE TABLE [__EFMigrationsHistory] (
    [MigrationId] nvarchar(150) NOT NULL,
    [ProductVersion] nvarchar(32) NOT NULL,
    CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
);
2020-04-19 16:31:43.9698|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-04-19 16:31:43.9797|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2020-04-19 16:31:43.9797|INFO|Microsoft.EntityFrameworkCore.Migrations|Applying migration '20200418185242_Initial'.
2020-04-19 16:31:44.0084|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
CREATE TABLE [Products] (
    [Id] int NOT NULL IDENTITY,
    [AvaliableQuantity] int NOT NULL,
    [Price] decimal(18, 2) NOT NULL,
    CONSTRAINT [PK_Products] PRIMARY KEY ([Id])
);
2020-04-19 16:31:44.0120|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
CREATE TABLE [Users] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(50) NOT NULL,
    CONSTRAINT [PK_Users] PRIMARY KEY ([Id])
);
2020-04-19 16:31:44.0120|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
CREATE TABLE [Orders] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [ProductId] int NOT NULL,
    [Quantity] int NOT NULL,
    CONSTRAINT [PK_Orders] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Orders_Products_ProductId] FOREIGN KEY ([ProductId]) REFERENCES [Products] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Orders_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2020-04-19 16:31:44.0427|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (24ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'AvaliableQuantity', N'Price') AND [object_id] = OBJECT_ID(N'[Products]'))
    SET IDENTITY_INSERT [Products] ON;
INSERT INTO [Products] ([Id], [AvaliableQuantity], [Price])
VALUES (1, 10, 100.0),
(2, 3, 1000.0),
(3, 0, 10.0);
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'AvaliableQuantity', N'Price') AND [object_id] = OBJECT_ID(N'[Products]'))
    SET IDENTITY_INSERT [Products] OFF;
2020-04-19 16:31:44.0427|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Name') AND [object_id] = OBJECT_ID(N'[Users]'))
    SET IDENTITY_INSERT [Users] ON;
INSERT INTO [Users] ([Id], [Name])
VALUES (1, N'Sam'),
(2, N'Bob'),
(3, N'Ben');
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Name') AND [object_id] = OBJECT_ID(N'[Users]'))
    SET IDENTITY_INSERT [Users] OFF;
2020-04-19 16:31:44.0622|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (9ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'ProductId', N'Quantity', N'UserId') AND [object_id] = OBJECT_ID(N'[Orders]'))
    SET IDENTITY_INSERT [Orders] ON;
INSERT INTO [Orders] ([Id], [ProductId], [Quantity], [UserId])
VALUES (1, 1, 10, 1),
(2, 1, 10, 1),
(3, 2, 10, 2),
(4, 3, 10, 2),
(5, 2, 10, 3),
(6, 3, 10, 3);
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'ProductId', N'Quantity', N'UserId') AND [object_id] = OBJECT_ID(N'[Orders]'))
    SET IDENTITY_INSERT [Orders] OFF;
2020-04-19 16:31:44.0622|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
CREATE INDEX [IX_Orders_ProductId] ON [Orders] ([ProductId]);
2020-04-19 16:31:44.0622|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
CREATE INDEX [IX_Orders_UserId] ON [Orders] ([UserId]);
2020-04-19 16:31:44.0729|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20200418185242_Initial', N'2.1.14-servicing-32113');
2020-04-19 16:31:44.0729|INFO|Microsoft.EntityFrameworkCore.Migrations|Applying migration '20200418185321_Initial1'.
2020-04-19 16:31:44.1306|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (47ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
DECLARE @var0 sysname;
SELECT @var0 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Products]') AND [c].[name] = N'Price');
IF @var0 IS NOT NULL EXEC(N'ALTER TABLE [Products] DROP CONSTRAINT [' + @var0 + '];');
ALTER TABLE [Products] ALTER COLUMN [Price] int NOT NULL;
2020-04-19 16:31:44.1306|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
UPDATE [Products] SET [Price] = 100
WHERE [Id] = 1;
SELECT @@ROWCOUNT;
2020-04-19 16:31:44.1367|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
UPDATE [Products] SET [Price] = 1000
WHERE [Id] = 2;
SELECT @@ROWCOUNT;
2020-04-19 16:31:44.1367|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
UPDATE [Products] SET [Price] = 10
WHERE [Id] = 3;
SELECT @@ROWCOUNT;
2020-04-19 16:31:44.1367|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20200418185321_Initial1', N'2.1.14-servicing-32113');
2020-04-19 16:31:44.2882|INFO|Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager|User profile is available. Using 'C:\Users\kvankadari\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2020-04-19 16:31:44.9612|INFO|Microsoft.AspNetCore.Hosting.Internal.WebHost|Request starting HTTP/1.1 DEBUG http://localhost:1028/  0
2020-04-19 16:31:44.9612|INFO|Microsoft.AspNetCore.Hosting.Internal.WebHost|Request starting HTTP/1.1 GET http://localhost:1028/  
2020-04-19 16:31:45.0592|INFO|Microsoft.AspNetCore.Hosting.Internal.WebHost|Request finished in 98.4345ms 200 
2020-04-19 16:31:45.2444|INFO|Microsoft.AspNetCore.Hosting.Internal.WebHost|Request finished in 284.7233ms 404 text/plain
2020-04-19 16:31:45.2810|INFO|Microsoft.AspNetCore.Hosting.Internal.WebHost|Request starting HTTP/1.1 GET http://localhost:1028/robots.txt  
2020-04-19 16:31:45.2810|INFO|Microsoft.AspNetCore.Hosting.Internal.WebHost|Request finished in 3.4933ms 404 text/plain
2020-04-19 16:31:45.5876|INFO|Microsoft.AspNetCore.Hosting.Internal.WebHost|Request starting HTTP/1.1 GET http://localhost:1028/favicon.ico  
2020-04-19 16:31:45.5912|INFO|Microsoft.AspNetCore.Hosting.Internal.WebHost|Request finished in 2.8892ms 404 text/plain
2020-04-19 16:32:13.8241|INFO|Microsoft.AspNetCore.Hosting.Internal.WebHost|Request starting HTTP/1.1 POST http://localhost:1028/api/orders/process application/json 78
2020-04-19 16:32:13.8836|INFO|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|Route matched with {action = "ProcessOrder", controller = "Order"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult ProcessOrder(OrderProcess.API.Models.ProcessOrderDto) on controller OrderProcess.API.Controllers.OrderController (OrderProcess.API).
2020-04-19 16:32:13.9897|INFO|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|Executing action method OrderProcess.API.Controllers.OrderController.ProcessOrder (OrderProcess.API) - Validation state: Valid
2020-04-19 16:32:14.0110|INFO|Microsoft.EntityFrameworkCore.Infrastructure|Entity Framework Core 2.1.14-servicing-32113 initialized 'ProcessOrderContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2020-04-19 16:32:14.1057|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (2ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [x].[Id], [x].[AvaliableQuantity], [x].[Price]
FROM [Products] AS [x]
WHERE [x].[Id] = @__productId_0
2020-04-19 16:32:14.1369|INFO|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|Executed action method OrderProcess.API.Controllers.OrderController.ProcessOrder (OrderProcess.API), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 141.2761ms.
2020-04-19 16:32:14.1369|INFO|Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor|Executing ObjectResult, writing value of type 'OrderProcess.API.Models.Response`1[[System.Boolean, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2020-04-19 16:32:14.1678|INFO|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|Executed action OrderProcess.API.Controllers.OrderController.ProcessOrder (OrderProcess.API) in 279.0138ms
2020-04-19 16:32:14.1678|INFO|Microsoft.AspNetCore.Hosting.Internal.WebHost|Request finished in 348.9355ms 200 application/json; charset=utf-8
2020-04-19 16:32:37.1772|INFO|OrderProcess.API.Program|Initializing application...
2020-04-19 16:32:38.8446|INFO|Microsoft.EntityFrameworkCore.Infrastructure|Entity Framework Core 2.1.14-servicing-32113 initialized 'ProcessOrderContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2020-04-19 16:32:40.1740|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (7ms) [Parameters=[], CommandType='Text', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [ProcessDB] SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
END;
2020-04-19 16:32:40.2071|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (29ms) [Parameters=[], CommandType='Text', CommandTimeout='60']
DROP DATABASE [ProcessDB];
2020-04-19 16:32:50.5376|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (313ms) [Parameters=[], CommandType='Text', CommandTimeout='60']
CREATE DATABASE [ProcessDB];
2020-04-19 16:32:50.5926|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (53ms) [Parameters=[], CommandType='Text', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [ProcessDB] SET READ_COMMITTED_SNAPSHOT ON;
END;
2020-04-19 16:32:50.6400|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (10ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
CREATE TABLE [__EFMigrationsHistory] (
    [MigrationId] nvarchar(150) NOT NULL,
    [ProductVersion] nvarchar(32) NOT NULL,
    CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
);
2020-04-19 16:32:50.6400|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-04-19 16:32:50.6400|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2020-04-19 16:32:50.6562|INFO|Microsoft.EntityFrameworkCore.Migrations|Applying migration '20200418185242_Initial'.
2020-04-19 16:32:50.6756|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
CREATE TABLE [Products] (
    [Id] int NOT NULL IDENTITY,
    [AvaliableQuantity] int NOT NULL,
    [Price] decimal(18, 2) NOT NULL,
    CONSTRAINT [PK_Products] PRIMARY KEY ([Id])
);
2020-04-19 16:32:50.6756|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
CREATE TABLE [Users] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(50) NOT NULL,
    CONSTRAINT [PK_Users] PRIMARY KEY ([Id])
);
2020-04-19 16:32:50.6756|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
CREATE TABLE [Orders] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [ProductId] int NOT NULL,
    [Quantity] int NOT NULL,
    CONSTRAINT [PK_Orders] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Orders_Products_ProductId] FOREIGN KEY ([ProductId]) REFERENCES [Products] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Orders_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2020-04-19 16:32:50.7103|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (23ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'AvaliableQuantity', N'Price') AND [object_id] = OBJECT_ID(N'[Products]'))
    SET IDENTITY_INSERT [Products] ON;
INSERT INTO [Products] ([Id], [AvaliableQuantity], [Price])
VALUES (1, 10, 100.0),
(2, 3, 1000.0),
(3, 0, 10.0);
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'AvaliableQuantity', N'Price') AND [object_id] = OBJECT_ID(N'[Products]'))
    SET IDENTITY_INSERT [Products] OFF;
2020-04-19 16:32:50.7183|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Name') AND [object_id] = OBJECT_ID(N'[Users]'))
    SET IDENTITY_INSERT [Users] ON;
INSERT INTO [Users] ([Id], [Name])
VALUES (1, N'Sam'),
(2, N'Bob'),
(3, N'Ben');
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Name') AND [object_id] = OBJECT_ID(N'[Users]'))
    SET IDENTITY_INSERT [Users] OFF;
2020-04-19 16:32:50.7183|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (7ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'ProductId', N'Quantity', N'UserId') AND [object_id] = OBJECT_ID(N'[Orders]'))
    SET IDENTITY_INSERT [Orders] ON;
INSERT INTO [Orders] ([Id], [ProductId], [Quantity], [UserId])
VALUES (1, 1, 10, 1),
(2, 1, 10, 1),
(3, 2, 10, 2),
(4, 3, 10, 2),
(5, 2, 10, 3),
(6, 3, 10, 3);
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'ProductId', N'Quantity', N'UserId') AND [object_id] = OBJECT_ID(N'[Orders]'))
    SET IDENTITY_INSERT [Orders] OFF;
2020-04-19 16:32:50.7332|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
CREATE INDEX [IX_Orders_ProductId] ON [Orders] ([ProductId]);
2020-04-19 16:32:50.7332|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
CREATE INDEX [IX_Orders_UserId] ON [Orders] ([UserId]);
2020-04-19 16:32:50.7332|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20200418185242_Initial', N'2.1.14-servicing-32113');
2020-04-19 16:32:50.7332|INFO|Microsoft.EntityFrameworkCore.Migrations|Applying migration '20200418185321_Initial1'.
2020-04-19 16:32:50.7953|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (44ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
DECLARE @var0 sysname;
SELECT @var0 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Products]') AND [c].[name] = N'Price');
IF @var0 IS NOT NULL EXEC(N'ALTER TABLE [Products] DROP CONSTRAINT [' + @var0 + '];');
ALTER TABLE [Products] ALTER COLUMN [Price] int NOT NULL;
2020-04-19 16:32:50.7953|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
UPDATE [Products] SET [Price] = 100
WHERE [Id] = 1;
SELECT @@ROWCOUNT;
2020-04-19 16:32:50.7953|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
UPDATE [Products] SET [Price] = 1000
WHERE [Id] = 2;
SELECT @@ROWCOUNT;
2020-04-19 16:32:50.7953|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
UPDATE [Products] SET [Price] = 10
WHERE [Id] = 3;
SELECT @@ROWCOUNT;
2020-04-19 16:32:50.7953|INFO|Microsoft.EntityFrameworkCore.Database.Command|Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20200418185321_Initial1', N'2.1.14-servicing-32113');
2020-04-19 16:32:50.8621|INFO|Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager|User profile is available. Using 'C:\Users\kvankadari\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2020-04-19 16:32:51.3254|INFO|Microsoft.AspNetCore.Hosting.Internal.WebHost|Request starting HTTP/1.1 GET http://localhost:1028/  
2020-04-19 16:32:51.3254|INFO|Microsoft.AspNetCore.Hosting.Internal.WebHost|Request starting HTTP/1.1 DEBUG http://localhost:1028/  0
2020-04-19 16:32:51.3637|INFO|Microsoft.AspNetCore.Hosting.Internal.WebHost|Request finished in 37.1373ms 200 
2020-04-19 16:32:51.4715|INFO|Microsoft.AspNetCore.Hosting.Internal.WebHost|Request finished in 148.0993ms 404 text/plain
2020-04-19 16:32:59.9235|INFO|Microsoft.AspNetCore.Hosting.Internal.WebHost|Request starting HTTP/1.1 POST http://localhost:1028/api/orders/process application/json 77
2020-04-19 16:32:59.9532|INFO|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|Route matched with {action = "ProcessOrder", controller = "Order"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult ProcessOrder(OrderProcess.API.Models.ProcessOrderDto) on controller OrderProcess.API.Controllers.OrderController (OrderProcess.API).
2020-04-19 16:33:00.0234|INFO|Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor|Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.SerializableError'.
2020-04-19 16:33:00.0386|INFO|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|Executed action OrderProcess.API.Controllers.OrderController.ProcessOrder (OrderProcess.API) in 81.0581ms
2020-04-19 16:33:00.0386|INFO|Microsoft.AspNetCore.Hosting.Internal.WebHost|Request finished in 119.1564ms 400 application/json; charset=utf-8
2020-04-19 16:33:17.2459|INFO|Microsoft.AspNetCore.Hosting.Internal.WebHost|Request starting HTTP/1.1 POST http://localhost:1028/api/orders/process application/json 76
2020-04-19 16:33:17.2543|INFO|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|Route matched with {action = "ProcessOrder", controller = "Order"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult ProcessOrder(OrderProcess.API.Models.ProcessOrderDto) on controller OrderProcess.API.Controllers.OrderController (OrderProcess.API).
2020-04-19 16:33:17.2650|INFO|Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor|Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.SerializableError'.
2020-04-19 16:33:17.2650|INFO|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|Executed action OrderProcess.API.Controllers.OrderController.ProcessOrder (OrderProcess.API) in 10.7209ms
2020-04-19 16:33:17.2650|INFO|Microsoft.AspNetCore.Hosting.Internal.WebHost|Request finished in 27.9824ms 400 application/json; charset=utf-8
